[tools]
bun = "1.3.5"
"npm:@dotenvx/dotenvx" = "latest"

# 環境変数の設定（必要に応じて追加）
[env]
NODE_ENV = "development"

# タスク定義
[tasks.dev]
description = "バックエンドとフロントエンドを並行起動"
depends = ["dev:backend", "dev:frontend"]

[tasks."dev:backend"]
description = "バックエンド開発サーバーを起動"
dir = "backend"
run = "bunx wrangler dev --port 8080"

[tasks."dev:frontend"]
description = "フロントエンド開発サーバーを起動"
run = "bun run dev:frontend"

[tasks.build]
description = "全パッケージをビルド"
run = "bun run build"

[tasks."build:backend"]
description = "バックエンドをビルド"
run = "bun run build:backend"

[tasks."build:frontend"]
description = "フロントエンドをビルド"
run = "bun run build:frontend"

[tasks.install]
description = "全ての依存関係をインストール"
run = "bun install"

[tasks.clean]
description = "node_modulesとビルド成果物を削除"
run = "bun run clean:script"

[tasks.typecheck]
description = "全パッケージの型チェック"
run = "bun run typecheck"

[tasks."typecheck:backend"]
description = "バックエンドの型チェック"
run = "bun run typecheck:backend"

[tasks."typecheck:frontend"]
description = "フロントエンドの型チェック"
run = "bun run typecheck:frontend"

[tasks.lint]
description = "oxlintでfrontend/backendをlint"
run = "bun run lint"

[tasks."lint:fix"]
description = "oxlintで自動修正（可能な範囲）"
run = "bun run lint:fix"

[tasks.format]
description = "oxfmtでfrontend/backendをフォーマット"
run = "bun run format"

[tasks."format:check"]
description = "oxfmtでフォーマット差分チェック"
run = "bun run format:check"

[tasks.check]
description = "lint + format:check"
run = "bun run check"

# dotenvx タスク
[tasks."dotenvx:help"]
description = "dotenvxのヘルプを表示"
run = "bun dotenvx help"

[tasks."dotenvx:get:backend"]
description = "バックエンドの環境変数を取得"
dir = "backend"
run = "bun dotenvx get"

[tasks."dotenvx:get:frontend"]
description = "フロントエンドの環境変数を取得"
dir = "frontend"
run = "bun dotenvx get"

[tasks."dotenvx:encrypt:backend"]
description = "バックエンドの環境変数を暗号化"
dir = "backend"
run = "bun dotenvx encrypt"

[tasks."dotenvx:encrypt:frontend"]
description = "フロントエンドの環境変数を暗号化"
dir = "frontend"
run = "bun dotenvx encrypt"

[tasks."db:generate"]
description = "データベースのマイグレーションを生成"
dir = "backend"
run = "bun run db:generate"

[tasks."db:migrate"]
description = "データベースのマイグレーションを適用"
dir = "backend"
run = "bun run db:migrate"

[tasks."db:studio"]
description = "データベースのスタジオを起動"
dir = "backend"
run = "bun run db:studio"
